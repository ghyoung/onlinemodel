<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡€ç¼˜å…³ç³» - æ¹–ä»“å»ºæ¨¡å·¥å…·</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/reset.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            overflow: hidden;
        }
        
        .lineage-container {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .toolbar {
            height: 64px;
            background: #fff;
            border-bottom: 1px solid #e8e8e8;
            display: flex;
            align-items: center;
            padding: 0 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .toolbar-left {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .toolbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .toolbar-btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            background: #fff;
            color: #595959;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .toolbar-btn:hover {
            border-color: #1890ff;
            color: #1890ff;
        }
        
        .toolbar-btn.active {
            background: #1890ff;
            color: #fff;
            border-color: #1890ff;
        }
        
        .search-box {
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            font-size: 14px;
            width: 300px;
            margin-right: 16px;
        }
        
        .search-box:focus {
            outline: none;
            border-color: #1890ff;
        }
        
        .depth-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-right: 16px;
        }
        
        .depth-label {
            font-size: 14px;
            color: #595959;
        }
        
        .depth-input {
            width: 60px;
            padding: 4px 8px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .sidebar {
            width: 300px;
            background: #fff;
            border-right: 1px solid #e8e8e8;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-header {
            padding: 16px;
            border-bottom: 1px solid #e8e8e8;
            background: #fafafa;
        }
        
        .sidebar-title {
            font-size: 16px;
            font-weight: 600;
            color: #262626;
            margin-bottom: 8px;
        }
        
        .sidebar-subtitle {
            font-size: 12px;
            color: #8c8c8c;
        }
        
        .sidebar-content {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
        }
        
        .node-item {
            padding: 12px;
            border: 1px solid #f0f0f0;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .node-item:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .node-item.selected {
            border-color: #1890ff;
            background: #e6f7ff;
        }
        
        .node-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .node-name {
            font-weight: 600;
            color: #262626;
        }
        
        .node-type {
            font-size: 12px;
            color: #8c8c8c;
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .node-details {
            font-size: 12px;
            color: #595959;
        }
        
        .lineage-canvas {
            flex: 1;
            background: #fafafa;
            position: relative;
            overflow: hidden;
        }
        
        .canvas-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .lineage-node {
            position: absolute;
            width: 120px;
            height: 60px;
            background: #fff;
            border: 2px solid #d9d9d9;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .lineage-node:hover {
            border-color: #1890ff;
            box-shadow: 0 4px 16px rgba(24, 144, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .lineage-node.selected {
            border-color: #1890ff;
            background: #f0f8ff;
        }
        
        .lineage-node.source {
            border-color: #52c41a;
            background: #f6ffed;
        }
        
        .lineage-node.target {
            border-color: #faad14;
            background: #fffbe6;
        }
        
        .node-title {
            font-size: 12px;
            font-weight: 600;
            color: #262626;
            text-align: center;
            margin-bottom: 4px;
        }
        
        .node-info {
            font-size: 10px;
            color: #8c8c8c;
            text-align: center;
        }
        
        .lineage-arrow {
            position: absolute;
            pointer-events: none;
        }
        
        .arrow-path {
            stroke: #8c8c8f;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }
        
        .arrow-path.highlighted {
            stroke: #1890ff;
            stroke-width: 3;
        }
        
        .canvas-controls {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .control-btn {
            width: 40px;
            height: 40px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            background: #fff;
            color: #595959;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .control-btn:hover {
            border-color: #1890ff;
            color: #1890ff;
        }
        
        .zoom-info {
            position: absolute;
            bottom: 16px;
            left: 16px;
            background: rgba(0,0,0,0.7);
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
        }
        
        .path-info {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #fff;
            border: 1px solid #e8e8e8;
            border-radius: 6px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 300px;
            display: none;
        }
        
        .path-title {
            font-weight: 600;
            color: #262626;
            margin-bottom: 8px;
        }
        
        .path-details {
            font-size: 12px;
            color: #595959;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="lineage-container">
        <div class="toolbar">
            <div class="toolbar-left">
                <input type="text" class="search-box" placeholder="æœç´¢è¡¨åæˆ–å­—æ®µå...">
                <div class="depth-control">
                    <span class="depth-label">è¡€ç¼˜æ·±åº¦:</span>
                    <input type="number" class="depth-input" value="3" min="1" max="10">
                </div>
                <button class="toolbar-btn active">ğŸ” è¡€ç¼˜åˆ†æ</button>
                <button class="toolbar-btn">ğŸ”„ å½±å“åˆ†æ</button>
                <button class="toolbar-btn">ğŸ“Š ç»Ÿè®¡æŠ¥å‘Š</button>
            </div>
            
            <div class="toolbar-right">
                <button class="toolbar-btn">ğŸ“¤ å¯¼å‡º</button>
                <button class="toolbar-btn">ğŸ–¼ï¸ æˆªå›¾</button>
                <button class="toolbar-btn">âš™ï¸ è®¾ç½®</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">è¡€ç¼˜èŠ‚ç‚¹</div>
                    <div class="sidebar-subtitle">å…± 8 ä¸ªèŠ‚ç‚¹</div>
                </div>
                
                <div class="sidebar-content">
                    <div class="node-item selected">
                        <div class="node-header">
                            <span class="node-name">user_profile</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯è¡¨ â€¢ 8ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">order_info</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">è®¢å•ä¿¡æ¯è¡¨ â€¢ 12ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">user_order_summary</span>
                            <span class="node-type">è§†å›¾</span>
                        </div>
                        <div class="node-details">ç”¨æˆ·è®¢å•æ±‡æ€»è§†å›¾ â€¢ 5ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">user_analysis</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">ç”¨æˆ·åˆ†æè¡¨ â€¢ 15ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">report_daily</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">æ—¥æŠ¥è¡¨ â€¢ 20ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">report_weekly</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">å‘¨æŠ¥è¡¨ â€¢ 18ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">report_monthly</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">æœˆæŠ¥è¡¨ â€¢ 22ä¸ªå­—æ®µ</div>
                    </div>
                    
                    <div class="node-item">
                        <div class="node-header">
                            <span class="node-name">dashboard_data</span>
                            <span class="node-type">è¡¨</span>
                        </div>
                        <div class="node-details">ä»ªè¡¨æ¿æ•°æ®è¡¨ â€¢ 25ä¸ªå­—æ®µ</div>
                    </div>
                </div>
            </div>
            
            <div class="lineage-canvas">
                <div class="canvas-container">
                    <!-- è¡€ç¼˜èŠ‚ç‚¹ -->
                    <div class="lineage-node source" style="top: 100px; left: 200px;">
                        <div class="node-title">user_profile</div>
                        <div class="node-info">è¡¨ â€¢ 8å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 100px; left: 400px;">
                        <div class="node-title">order_info</div>
                        <div class="node-info">è¡¨ â€¢ 12å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 100px; left: 600px;">
                        <div class="node-title">product_info</div>
                        <div class="node-info">è¡¨ â€¢ 15å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 250px; left: 300px;">
                        <div class="node-title">user_order_summary</div>
                        <div class="node-info">è§†å›¾ â€¢ 5å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 250px; left: 500px;">
                        <div class="node-title">order_product_summary</div>
                        <div class="node-info">è§†å›¾ â€¢ 6å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 400px; left: 200px;">
                        <div class="node-title">user_analysis</div>
                        <div class="node-info">è¡¨ â€¢ 15å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node" style="top: 400px; left: 400px;">
                        <div class="node-title">report_daily</div>
                        <div class="node-info">è¡¨ â€¢ 20å­—æ®µ</div>
                    </div>
                    
                    <div class="lineage-node target" style="top: 400px; left: 600px;">
                        <div class="node-title">dashboard_data</div>
                        <div class="node-info">è¡¨ â€¢ 25å­—æ®µ</div>
                    </div>
                    
                    <!-- è¡€ç¼˜ç®­å¤´ -->
                    <svg class="lineage-arrow" width="100%" height="100%" style="position: absolute; top: 0; left: 0;">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                                    refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#8c8c8f" />
                            </marker>
                        </defs>
                        
                        <!-- è¡€ç¼˜å…³ç³»çº¿ -->
                        <path d="M 260 130 L 380 130" class="arrow-path" />
                        <path d="M 460 130 L 580 130" class="arrow-path" />
                        <path d="M 260 130 L 350 250" class="arrow-path" />
                        <path d="M 460 130 L 550 250" class="arrow-path" />
                        <path d="M 350 250 L 260 400" class="arrow-path" />
                        <path d="M 350 250 L 460 400" class="arrow-path" />
                        <path d="M 550 250 L 460 400" class="arrow-path" />
                        <path d="M 550 250 L 660 400" class="arrow-path" />
                        <path d="M 260 400 L 460 400" class="arrow-path" />
                        <path d="M 460 400 L 660 400" class="arrow-path" />
                    </svg>
                </div>
                
                <div class="canvas-controls">
                    <button class="control-btn" title="æ”¾å¤§">ğŸ”+</button>
                    <button class="control-btn" title="ç¼©å°">ğŸ”-</button>
                    <button class="control-btn" title="é€‚åº”ç”»å¸ƒ">ğŸ“</button>
                    <button class="control-btn" title="é‡ç½®è§†å›¾">ğŸ”„</button>
                </div>
                
                <div class="zoom-info">
                    ç¼©æ”¾: 100% | æ‹–æ‹½ç§»åŠ¨ | æ»šè½®ç¼©æ”¾
                </div>
                
                <div class="path-info" id="pathInfo">
                    <div class="path-title">è¡€ç¼˜è·¯å¾„</div>
                    <div class="path-details">
                        ä» user_profile åˆ° dashboard_data çš„è¡€ç¼˜è·¯å¾„ï¼š
                        <br>user_profile â†’ user_order_summary â†’ user_analysis â†’ dashboard_data
                        <br><br>
                        å½±å“å­—æ®µï¼šç”¨æˆ·IDã€ç”¨æˆ·å§“åã€è®¢å•æ•°é‡ã€æ¶ˆè´¹é‡‘é¢ç­‰
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // èŠ‚ç‚¹é€‰æ‹©
        document.querySelectorAll('.node-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.node-item').forEach(i => i.classList.remove('selected'));
                item.classList.add('selected');
            });
        });
        
        // è¡€ç¼˜èŠ‚ç‚¹ç‚¹å‡»
        document.querySelectorAll('.lineage-node').forEach(node => {
            node.addEventListener('click', () => {
                document.querySelectorAll('.lineage-node').forEach(n => n.classList.remove('selected'));
                node.classList.add('selected');
                
                // æ˜¾ç¤ºè·¯å¾„ä¿¡æ¯
                const pathInfo = document.getElementById('pathInfo');
                pathInfo.style.display = 'block';
            });
        });
        
        // ç”»å¸ƒæ‹–æ‹½
        let isDragging = false;
        let startX, startY, startScrollX, startScrollY;
        
        const canvas = document.querySelector('.lineage-canvas');
        
        canvas.addEventListener('mousedown', (e) => {
            if (e.target.classList.contains('lineage-node')) return;
            
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            startScrollX = canvas.scrollLeft;
            startScrollY = canvas.scrollTop;
            canvas.style.cursor = 'grabbing';
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            canvas.scrollLeft = startScrollX - deltaX;
            canvas.scrollTop = startScrollY - deltaY;
        });
        
        canvas.addEventListener('mouseup', () => {
            isDragging = false;
            canvas.style.cursor = 'default';
        });
        
        // ç¼©æ”¾æ§åˆ¶
        let currentZoom = 1;
        
        document.querySelector('.control-btn[title="æ”¾å¤§"]').addEventListener('click', () => {
            currentZoom = Math.min(currentZoom * 1.2, 3);
            updateZoom();
        });
        
        document.querySelector('.control-btn[title="ç¼©å°"]').addEventListener('click', () => {
            currentZoom = Math.max(currentZoom / 1.2, 0.3);
            updateZoom();
        });
        
        function updateZoom() {
            const container = document.querySelector('.canvas-container');
            container.style.transform = `scale(${currentZoom})`;
            container.style.transformOrigin = 'center center';
            
            document.querySelector('.zoom-info').textContent = `ç¼©æ”¾: ${Math.round(currentZoom * 100)}% | æ‹–æ‹½ç§»åŠ¨ | æ»šè½®ç¼©æ”¾`;
        }
        
        // æ»šè½®ç¼©æ”¾
        canvas.addEventListener('wheel', (e) => {
            e.preventDefault();
            
            if (e.deltaY < 0) {
                currentZoom = Math.min(currentZoom * 1.1, 3);
            } else {
                currentZoom = Math.max(currentZoom / 1.1, 0.3);
            }
            
            updateZoom();
        });
    </script>
</body>
</html>
