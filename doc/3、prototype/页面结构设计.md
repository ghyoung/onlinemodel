# 湖仓建模工具页面结构设计

## 1. 整体页面架构

### 1.1 页面层级结构
```
├── 登录页面 (Login)
├── 主应用 (MainApp)
│   ├── 顶部导航栏 (Header)
│   ├── 侧边菜单栏 (Sidebar)
│   └── 主内容区 (MainContent)
│       ├── 仪表板 (Dashboard)
│       ├── 数据源管理 (DataSourceManagement)
│       │   ├── 数据源管理列表
│       │   └── 数据表列表
│       ├── 模型管理 (ModelManagement)
│       │   ├── 新增/编辑模型（弹窗/抽屉/页面，内嵌在线建模）
│       │   ├── 导入DDL（弹窗/抽屉/页面，内嵌DDL导入）
│       ├── 血缘关系 (Lineage)
│       ├── 标准字段库 (FieldLibrary)
│       ├── 数据治理 (DataGovernance)
│       └── 系统设置 (SystemSettings)
└── 错误页面 (Error)
```

### 1.2 导航结构
- **一级导航**：顶部导航栏，包含Logo、全局搜索框、用户信息
- **二级导航**：侧边菜单栏，包含主要功能模块（新增"数据源管理"作为一级菜单）
- **三级导航**：面包屑导航，显示当前页面位置
- **快捷导航**：页面内的标签页或分组导航

## 2. 核心页面设计

### 2.1 登录页面 (Login)
**功能**：用户身份验证和系统登录
**布局**：居中卡片式布局
**组件**：
- 系统Logo和标题
- 用户名/邮箱输入框
- 密码输入框
- 记住密码复选框
- 登录按钮
- 忘记密码链接
- 注册账号链接

### 2.2 仪表板 (Dashboard)
**功能**：系统概览和关键指标展示
**布局**：网格卡片式布局
**组件**：
- 统计卡片（表数量、字段数量、用户数量等）
- 最近活动列表
- 快速操作按钮
- 系统状态监控
- 数据质量概览

### 2.3 数据源管理 (DataSourceManagement)
**功能**：统一管理所有数据源连接配置，支持多种数据库类型，提供数据源列表和表结构查看功能
**布局**：标签页布局，包含"数据源管理列表"和"数据表列表"两个标签页
**组件**：

**数据源管理列表标签页**：
- 数据源列表（表格形式，撑满主内容区）
- 搜索和筛选器（按名称、类型、状态等）
- 新增数据源按钮
- 数据源操作列（启用/禁用、编辑、删除、连接测试、同步状态查看）
- 数据源详情面板

**数据表列表标签页**：
- 数据表列表（表格形式，撑满主内容区）
- 搜索和筛选器（按数据源、数据库、表名等）
- 表结构查看按钮
- 表操作列（查看结构、导出、同步状态查看）
- 表结构详情面板（字段名、类型、长度、是否为空、默认值、主键等）

**验收标准**：
- 支持至少5种主流数据库类型
- 数据源列表加载时间 < 2秒
- 表结构查看响应时间 < 3秒
- 支持至少100个数据源和10000张表的元数据管理

### 2.4 在线建模 (OnlineModeling)
**入口**：不再作为独立菜单，仅在"模型管理"页面点击"新增模型"或"编辑模型"时以弹窗/抽屉/页面方式展示。
**功能**：提供类似飞书在线表格的建模体验
**布局**：全屏表格编辑器，主要展示数据模型编辑区域，支持响应式布局和横向滚动
**组件**：
- 工具栏（返回、标准字段库、列可见性、快速导入、更多功能）
- 主编辑区域：
  - 表结构编辑器（表名、描述、分层、主题域等）
  - 字段编辑器（字段名、类型、约束等，支持16列全字段编辑）
  - 关系编辑器（主键、外键、索引等）
  - 实时协作状态指示器
  - 横向滚动支持（当列数过多时自动显示横向滚动条）
- 更多功能菜单（下拉菜单）：
  - 📋 模型日志（模态框）：
    - 模型修改记录列表（支持按类型、时间、用户筛选）
    - 版本历史信息（支持版本对比和回滚）
    - 操作回滚功能
    - 日志详情展示（包含修改前后的对比）
    - 日志导出功能
    - 实时日志更新（支持WebSocket推送）
  - 💻 生成代码（模态框）：
    - 数仓开发代码展示（DDL、SQL、Python）
    - 数据库查询结果展示
    - 代码编辑和同步功能
  - ✅ 规范检查（模态框）：
    - 数据治理检查规则配置
    - 检查结果展示
    - 问题修复建议

**界面优化**：
- 移除了原有的Tab导航，简化界面结构
- 将次要功能移到"更多"菜单中，减少界面复杂度
- 主编辑区域直接展示数据模型，提升编辑效率
- 使用模态框展示日志、代码、规范检查功能，避免页面切换

**响应式设计**：
- 表格支持横向滚动，确保所有列都能正常显示
- 当屏幕宽度不足时，自动显示横向滚动条
- 表格列宽固定，避免内容被压缩
- 支持列可见性控制，用户可隐藏不常用的列

### 2.5 DDL导入 (DDLImport)
**入口**：不再作为独立菜单，仅在"模型管理"页面点击"导入"按钮时以弹窗/抽屉/页面方式展示。
**功能**：支持快速导入现有数仓的DDL语句，实现逆向建模
**布局**：分步骤向导式布局
**组件**：
- 步骤指示器（数据源选择→表选择→导入配置→执行导入）
- 数据源选择页面：展示已配置连接列表、连接状态
- 表列表展示和勾选
- 导入配置选项
- 导入进度监控
- 导入结果展示

**数据源选择优化**：
- 展示已配置的数据库连接列表供选择
- 若没有配置数据源，提供"添加数据源"链接，跳转到新增数据源界面
- 支持数据源连接状态实时检查
- 支持数据源快速切换和重新连接

**流程优化**：
- 移除第一步"连接配置"，直接展示已配置的数据源列表
- 简化用户操作流程，提升导入效率
- 支持从数据源管理页面快速添加新数据源

### 2.6 模型管理 (ModelManagement)
**功能**：管理已创建的模型和表结构，作为"在线建模""DDL导入"的主入口。
**布局**：列表+详情布局，内容区域自适应撑满屏幕，减少空白，提升信息密度。
**组件**：
- 模型列表（表格形式，撑满主内容区）
- 搜索和筛选器
- 模型详情面板
- 版本管理
- 导出功能
- 新增/编辑模型按钮（触发在线建模弹窗/页面）
- 导入按钮（触发DDL导入弹窗/页面）

### 2.7 血缘关系 (Lineage)
**功能**：可视化展示模型血缘关系
**布局**：全屏图形展示
**组件**：
- 血缘图画布
- 工具栏（缩放、拖拽、搜索、筛选）
- 血缘深度控制
- 节点详情面板
- 血缘路径追踪

### 2.8 标准字段库 (FieldLibrary)
**功能**：维护标准化的字段定义库
**布局**：分类+列表布局
**组件**：
- 字段分类树
- 字段列表（表格形式）
- 字段详情面板
- 搜索和筛选
- 字段推荐

### 2.9 数据治理 (DataGovernance)
**功能**：提供智能化的数据治理能力
**布局**：仪表板+列表布局
**组件**：
- 治理概览仪表板
- 规则配置
- 执行结果列表
- 质量报告
- 治理建议

### 2.10 系统设置 (SystemSettings)
**功能**：系统配置和用户管理
**布局**：标签页布局
**组件**：
- 用户管理
- 权限配置
- 系统配置
- 主题域配置（公共配置）
- 分层配置（公共配置）
- 日志查看

**新增配置项**：
- **主题域配置**：管理公共的主题域分类，支持新增、编辑、删除、排序等操作
- **分层配置**：管理公共的数仓分层配置（ODS、DWD、DIM、DWS、ADS），支持自定义分层名称和描述

## 3. 页面交互设计

### 3.1 页面跳转
- **主菜单跳转**：点击侧边菜单项，切换主内容区（新增"数据源管理"菜单项）
- **面包屑跳转**：点击面包屑导航，快速返回上级页面
- **快捷操作跳转**：通过按钮、链接等快速跳转
- **返回操作**：支持浏览器后退、ESC键返回

### 3.2 状态管理
- **页面状态**：当前页面、选中项、展开状态等
- **数据状态**：加载中、成功、失败、空数据等
- **用户状态**：登录状态、权限状态、偏好设置等
- **系统状态**：网络状态、服务状态、错误状态等

### 3.3 响应式适配
- **桌面端**：完整功能，多列布局
- **平板端**：侧边栏可折叠，保持核心功能
- **移动端**：简化布局，重点功能优先

## 4. 页面组件复用

### 4.1 通用组件
- **Header**：顶部导航栏，所有页面共用，包含Logo、全局搜索框、用户信息
- **Sidebar**：侧边菜单栏，主应用页面共用
- **Breadcrumb**：面包屑导航，支持动态生成
- **SearchBox**：全局搜索框，支持模型、表、字段、文档等内容的快速检索，位于Header区域
- **StatusBar**：状态栏，显示系统状态

### 4.2 业务组件
- **TableEditor**：表格编辑器，在线建模页面使用
- **LineageGraph**：血缘图组件，血缘关系页面使用
- **FieldSelector**：字段选择器，建模页面使用
- **ImportWizard**：导入向导，DDL导入页面使用
- **ModelViewer**：模型查看器，模型管理页面使用
- **DataSourceManager**：数据源管理组件，数据源管理页面使用

### 4.3 布局组件
- **PageContainer**：页面容器，提供统一的页面布局
- **Card**：卡片容器，用于内容分组
- **Panel**：面板容器，用于侧边内容展示
- **Modal**：模态框，用于弹窗操作
- **Drawer**：抽屉，用于侧边内容展示

## 5. 页面性能优化

### 5.1 加载优化
- **懒加载**：按需加载页面组件
- **预加载**：预加载常用页面
- **缓存策略**：合理使用浏览器缓存
- **代码分割**：按页面分割代码包

### 5.2 渲染优化
- **虚拟滚动**：大数据列表使用虚拟滚动
- **防抖节流**：搜索、滚动等操作使用防抖节流
- **组件缓存**：合理使用React.memo等优化
- **状态优化**：避免不必要的状态更新

### 5.3 交互优化
- **骨架屏**：加载时显示骨架屏
- **进度指示**：长时间操作显示进度
- **错误边界**：捕获和处理页面错误
- **离线支持**：支持离线查看已加载内容

## 6. 全局搜索交互设计
### 6.1 入口位置
- Header区域Logo右侧，风格符合设计规范
### 6.2 交互流程
1. 点击搜索框/按钮，弹出全局搜索面板（支持快捷键如Ctrl+K）
2. 输入关键词，自动联想模型、表、字段、文档等
3. 搜索结果分组展示，支持键盘上下选择、回车跳转
4. 支持历史搜索、热词推荐
### 6.3 结果展示
- 分组（模型/表/字段/文档）
- 结果高亮、可点击跳转
- 支持无结果提示

## 7. 页面结构调整总结

### 7.1 主要变更
1. **新增数据源管理一级菜单**：从系统设置中提取出来，下设数据源管理列表和数据表列表两个标签页
2. **调整DDL导入流程**：移除第一步"连接配置"，改为展示已配置的数据库连接列表供选择
3. **移除文档管理模块**：模型构建成功后，飞书表格文档承担模型责任，不再需要独立的文档管理模块
4. **系统设置新增配置项**：主题域、分层等公共配置移到系统设置中统一管理

### 7.2 页面流程优化
- **数据源管理**：统一入口，支持数据源和表结构的集中管理
- **DDL导入**：简化流程，直接选择已配置的数据源
- **模型管理**：作为建模和导入的主入口，流程更加清晰
- **系统配置**：集中管理公共配置项，提升管理效率

### 7.3 界面优化
- **移除冗余导航**：每个页面不再有独立的page-header，统一使用框架的面包屑导航
- **提升信息密度**：内容区域自适应撑满屏幕，减少空白区域
- **简化用户操作**：优化流程，减少不必要的步骤和界面元素

### 7.4 原型页面状态
- **已完成页面**：所有核心功能页面原型已完成，包括数据源管理、模型管理、DDL导入、在线建模等
- **页面结构优化**：已移除各页面的独立page-header，统一使用框架导航
- **流程优化**：DDL导入流程已简化，数据源管理已独立成一级菜单
- **界面清理**：已清理各页面的冗余代码和样式，提升页面性能

## 8. 开发优先级建议

### 8.1 第一阶段 (MVP - 8周)
- **数据源管理模块**：P0，核心功能，支持多种数据库连接和表结构管理
- **DDL快速导入模块**：P0，核心功能，支持现有数仓的快速导入
- **在线建模基础功能**：P0，核心功能，提供全屏独占式建模体验
- **标准字段库**：P0，核心功能，支持快速引用和分类管理
- **模型管理模块**：P0，核心功能，支持多种分类方式和字段级管理
- **系统设置**：P0，核心功能，包含主题域和分层等公共配置

### 8.2 第二阶段 (核心功能 - 12周)
- **可视化血缘关系图**：P1，重要功能，支持表级和字段级血缘展示
- **数据治理模块**：P1，重要功能，提供智能化数据治理能力
- **全局搜索功能**：P1，重要功能，支持多维度搜索和快速跳转
- **仪表板**：P1，重要功能，系统概览和关键指标展示

### 8.3 第三阶段 (高级功能 - 16周)
- **飞书文档同步**：P2，增强功能，自动同步飞书表格文档
- **协作功能**：P2，增强功能，多人协作建模和文档管理
- **模型文档比对**：P3，优化功能，设计文档与开发模型一致性比对
- **系统集成和测试**：完善系统功能和性能优化
